<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Gerencimento de eventos</title>
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">
  <link rel="stylesheet" href="/src/css/style.css">
  <link rel="stylesheet" href="/src/css/bootstrap.css">
  <link rel="manifest" href="/manifest.json">
</head>
<body>
<header class="main-header">  
</header>
<nav class="navbar navbar-expand-md navbar-dark bg-dark mb-4">
  <a class="navbar-brand" href="#"></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
          <a class="nav-link" href="index.html">Eventos <span class="sr-only">(current)</span></a>
      </li>    
      <li class="nav-item">
        <a class="nav-link" href="lista_eventos.html"> Lista de Eventos </a>
      </li>
      <li class="nav-item">
          <a class="nav-link" href="meu_cadastro.html">Cadastro</a>
      </li>      
       <li class="nav-item">
          <a class="nav-link" href="lista_presenca.html">Lista de Presença</a>
      </li>      
      </ul>        
  </div>
</nav>
<article class="card" id="pwa">  
  <section class='container'>
    <div class='row cont'>
        <div class='col-lg-12 lista'>
            <h1>Lista de Presença</h1>
        </div>                  
    </div>  
  </section>      
</article>

<script src="/src/js/app.js"></script>
<script src="/src/js/jquery.js"></script>   
<script>
   
  function atualizaLista(){

    $(".lista_evento").remove();
    var url_server ="https://filipeeduardo.com.br/rest-arquivo/api/evento/" //url do webserver que recebe a requisicao
    var url_local = "http://projetos/teste-wpa/servidor-predisul/api/evento/"
    var url ="http://projetos/teste-wpa/servidor-predisul/api/evento/ocupacao/1"; //pegar valor do id direto pela url da página 

    $.ajax({
    type: "get",
    url: url,
    data: {},
    dataType: "Json",
    success: function (r) {
    var evento = r.dados;
    console.log(r,evento);
      for(i=0; i< evento.length; i++){
      $(".cont").append(
        "<article class='col-sm-12 col-lg-4 lista_evento'>"+
            "<h3>"+evento[i].nome_user+"</h3>"+            
            "<p>"+evento[i].presenca+"</p>"+
            "<button onclick='alteraChamada("+evento[i].idInscricao+")'; class='presenca'>Presente</button></p>"+
        "</article>");
      }
    }          
    });   
  }

 function alteraChamada(idInscricao){

   $.ajax({
    type: "PUT",
    url:'http://projetos/teste-wpa/servidor-predisul/api/evento/ocupacao/'+idInscricao ,
    data:{idInscricao: idInscricao, presenca:1},
    dataType: "Json",
    success: function (r) {
      atualizaLista();
      }  
    });  

  return false;
}
 
 atualizaLista();

</script>
<script src="src/js/jquery.js"></script>    
<script src="src/js/bootstrap.min.js"></script>
</body>
</html>